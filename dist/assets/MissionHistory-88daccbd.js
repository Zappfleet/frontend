import{a_ as R,a$ as K,r as f,A as Q,j as s,F as w,c as n,b0 as A,b1 as Y,x as ee,aZ as te,b2 as ne,b3 as re,b4 as ae,y as ce}from"./index-0b0339af.js";import{u as de}from"./useItemSetToggle-41eb145a.js";import{r as U}from"./renderUi-49d0f127.js";import{e as $}from"./comments-4f6f4135.js";var le="Expected a function",V=0/0,ie="[object Symbol]",oe=/^\s+|\s+$/g,ue=/^[-+]0x[0-9a-f]+$/i,se=/^0b[01]+$/i,fe=/^0o[0-7]+$/i,he=parseInt,ge=typeof R=="object"&&R&&R.Object===Object&&R,be=typeof self=="object"&&self&&self.Object===Object&&self,ve=ge||be||Function("return this")(),me=Object.prototype,pe=me.toString,ye=Math.max,Ee=Math.min,P=function(){return ve.Date.now()};function xe(e,r,c){var l,u,t,d,i,h,m=0,N=!1,p=!1,x=!0;if(typeof e!="function")throw new TypeError(le);r=G(r)||0,W(c)&&(N=!!c.leading,p="maxWait"in c,t=p?ye(G(c.maxWait)||0,r):t,x="trailing"in c?!!c.trailing:x);function g(o){var b=l,y=u;return l=u=void 0,m=o,d=e.apply(y,b),d}function I(o){return m=o,i=setTimeout(S,r),N?g(o):d}function O(o){var b=o-h,y=o-m,C=r-b;return p?Ee(C,t-y):C}function k(o){var b=o-h,y=o-m;return h===void 0||b>=r||b<0||p&&y>=t}function S(){var o=P();if(k(o))return D(o);i=setTimeout(S,O(o))}function D(o){return i=void 0,x&&l?g(o):(l=u=void 0,d)}function _(){i!==void 0&&clearTimeout(i),m=0,l=h=u=i=void 0}function F(){return i===void 0?d:D(P())}function j(){var o=P(),b=k(o);if(l=arguments,u=this,h=o,b){if(i===void 0)return I(h);if(p)return i=setTimeout(S,r),g(h)}return i===void 0&&(i=setTimeout(S,r)),d}return j.cancel=_,j.flush=F,j}function W(e){var r=typeof e;return!!e&&(r=="object"||r=="function")}function Ne(e){return!!e&&typeof e=="object"}function Se(e){return typeof e=="symbol"||Ne(e)&&pe.call(e)==ie}function G(e){if(typeof e=="number")return e;if(Se(e))return V;if(W(e)){var r=typeof e.valueOf=="function"?e.valueOf():e;e=W(r)?r+"":r}if(typeof e!="string")return e===0?e:+e;e=e.replace(oe,"");var c=se.test(e);return c||fe.test(e)?he(e.slice(2),c?2:8):ue.test(e)?V:+e}var je=xe;const q=K(je);var Z=typeof window<"u"?f.useLayoutEffect:f.useEffect;function Te(e,r,c,l){const u=f.useRef(r);Z(()=>{u.current=r},[r]),f.useEffect(()=>{const t=(c==null?void 0:c.current)??window;if(!(t&&t.addEventListener))return;const d=i=>{u.current(i)};return t.addEventListener(e,d,l),()=>{t.removeEventListener(e,d,l)}},[e,c,l])}function Ie(e){const r=f.useRef(e);r.current=e,f.useEffect(()=>()=>{r.current()},[])}function Oe(e,r=500,c){const l=f.useRef();Ie(()=>{l.current&&l.current.cancel()});const u=f.useMemo(()=>{const t=q(e,r,c),d=(...i)=>t(...i);return d.cancel=()=>{t.cancel()},d.isPending=()=>!!l.current,d.flush=()=>t.flush(),d},[e,r,c]);return f.useEffect(()=>{l.current=q(e,r,c)},[e,r,c]),u}var J=typeof window>"u";function _e(e={}){let{initializeWithValue:r=!0}=e;J&&(r=!1);const c=()=>{if(!J)return window.screen},[l,u]=f.useState(()=>{if(r)return c()}),t=Oe(u,e==null?void 0:e.debounceDelay);function d(){const i=c(),h=e!=null&&e.debounceDelay?t:u;if(i){const{width:m,height:N,availHeight:p,availWidth:x,colorDepth:g,orientation:I,pixelDepth:O}=i;h({width:m,height:N,availHeight:p,availWidth:x,colorDepth:g,orientation:I,pixelDepth:O})}}return Te("resize",d),Z(()=>{d()},[]),l}function Me(e={}){var j,o,b,y,C;const{mode:r,paging:c,status:l}=e,u=r===te;console.log(52,l,c,r,u,u===!0);const{missions:t}=Q({mode:r,status:l,paging:c});console.log(741,t,c);const[d,i]=f.useState(1),h=30,[m,N]=f.useState(30),[p,x]=f.useState(0),[g,I]=f.useState([]),{items:O,toggleItem:k}=de({onlyOne:!0});_e(),f.useEffect(()=>{var a,v;console.log(65678,t),N(d*h),x(d*h-h),((a=t==null?void 0:t.data)==null?void 0:a.length)>0&&I((v=t==null?void 0:t.data)==null?void 0:v.slice(p,m))},[t,d]);const S=a=>{var M;const v=(M=a==null?void 0:a.extra)!=null&&M.comments?a.extra.comments:void 0,L=v==null?void 0:v.map(T=>{var H,z,B,X;return s(w,{children:[n("div",{className:"com0",children:n("span",{className:"title",children:`نظر ${T.role==="driver"?"راننده":"مسافر"}`})}),s("div",{className:"com1",children:[n("i",{style:{color:(H=$.find(E=>E.key===T.emojiID))==null?void 0:H.color},className:(z=$.find(E=>E.key===T.emojiID))==null?void 0:z.icon}),n("span",{children:(B=$.find(E=>E.key===T.emojiID))==null?void 0:B.value})]}),n("div",{className:"com2",children:n("p",{children:T.customComment})}),n("div",{className:"com3",children:(X=T.comments)==null?void 0:X.map(E=>n("span",{className:E.type,children:E.value}))})]})});return L?n("div",{className:"request-mycomment",children:s("div",{className:"row",children:[n("div",{className:"col-2 title",children:"نظرات"}),n("div",{className:"col-10",children:L})]})}):null};console.log("hgjhgjhgjhg100");const D=a=>{i(a)},_=((j=t==null?void 0:t.data)==null?void 0:j.length)>0?Math.ceil(((o=t==null?void 0:t.data)==null?void 0:o.length)/h):1,F=Array.from({length:Math.min(_,9)},(a,v)=>v+1);return s(w,{children:[!(t!=null&&t.data)&&n("p",{children:"Loading..."}),console.log(33,!A.isArray(t==null?void 0:t.data),t,(b=t==null?void 0:t.data)==null?void 0:b.length),(!A.isArray(t==null?void 0:t.data)||((y=t==null?void 0:t.data)==null?void 0:y.length)===0)&&n("p",{children:"موردی برای نمایش وجود ندارد"}),A.isArray(t==null?void 0:t.data)&&((C=t==null?void 0:t.data)==null?void 0:C.length)>0&&n("div",{className:"MissionHistory-component",children:n("div",{className:"row",children:n("div",{className:"col-12 have-table",children:(g==null?void 0:g.length)>0&&s(w,{children:[s("table",{className:"table table-hover",children:[n("thead",{children:s("tr",{children:[n("th",{children:"تاریخ و ساعت"}),n("th",{children:"ایجاد توسط"}),n("th",{children:"توزیع توسط"}),n("th",{children:"مسافت "}),n("th",{children:"وضعیت"}),U(n("th",{})).if(u),n("th",{children:""})]})}),n("tbody",{children:A.isArray(g)&&(g==null?void 0:g.map(a=>{const v=Y.find(M=>M[0]===a.status),L=O.includes(a._id);return s(w,{children:[s("tr",{children:[n("td",{children:a.mission_date&&ee(a.mission_date)}),n("td",{children:a.created_by}),n("td",{children:a.dispature}),n("td",{children:a.distance}),n("td",{children:v?v[1]:"نا مشخص"}),U(n("td",{children:n("div",{children:n("a",{href:`/driver/active?mission_id=${a._id}`,children:n("i",{className:"fa fa-eye icon-view"})})})})).if(u),n("td",{onClick:()=>k(a._id),children:n("i",{className:` angle-icon fa ${L?"fa-angle-down":"fa-angle-up"}`})})]},a._id),n("tr",{style:{display:L?"contents":"none"},children:n("td",{colSpan:6,children:n("div",{className:"expand",children:s("div",{children:[n(Ce,{mission:a}),S(a)]})})})})]})}))})]}),s("div",{className:"pagination",children:[n("button",{className:"pagination-button",onClick:()=>i(a=>Math.max(a-1,1)),disabled:d===1,children:"<"}),F.map(a=>n("button",{className:`pagination-button ${a===d?"active":""}`,onClick:()=>D(a),children:a},a)),n("button",{className:"pagination-button",onClick:()=>i(a=>Math.min(a+1,_)),disabled:d===_,children:">"})]})]})})})})]})}function Ce({mission:e}){var r;return n("table",{children:s("tbody",{children:[s("tr",{children:[n("td",{className:"name",children:ne}),n("td",{children:e==null?void 0:e.project_Code})]}),s("tr",{children:[n("td",{className:"name",children:re}),n("td",{children:e==null?void 0:e.cost_center})]}),s("tr",{children:[n("td",{className:"name",children:ae}),n("td",{children:n("ul",{children:(r=e==null?void 0:e.locations)==null?void 0:r.map(({meta:c},l)=>n(w,{children:s("li",{children:[n("span",{children:` ${ce(e.locations.length,l)} `}),c.address]})}))})})]})]})})}export{Me as M};
