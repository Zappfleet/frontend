import{r as t,x as ge,u as Ee,bd as Ae,bA as Ie,j as a,b as e,aq as se,a1 as ye,bS as Te,bT as Se,bU as De}from"./index-a6150745.js";/* empty css              */import{u as Pe}from"./useAganceDriver-6f189531.js";import{P as Re}from"./PlaqueInput-5fad7107.js";function _e(f,p){const[o,I]=t.useState(null),[y,T]=t.useState(null),[N,d]=t.useState({in_progress:!1});function g(){ge().selectAganceProfileByDriverId(p).then(m=>{I(m),T("selectVehicleByDriverID")}).catch(m=>{console.error(6001,"useAgenceVehicle selectVehicleByDriverID Error fetching list:",m)}).finally(()=>{d({...N,in_progress:!1})})}return t.useEffect(()=>{p&&g()},[f]),{result:o,type:y,state:N,refreshData:g}}const Oe=({handleBackClick:f,title:p})=>{var k,b,x,F,G,L,O,B,U,q,z,j,M,V,$,J,W,H,K,Q;p="پروفایل";const{authInfo:o}=Ee(),[I,y]=t.useState(""),[T,N]=t.useState({CREATE:!1,EDIT:!1,DELETE:!1});t.useEffect(()=>{var c,u;let s={CREATE:!1,EDIT:!1,DELETE:!1},l="";(u=(c=o==null?void 0:o.auth)==null?void 0:c.roles)==null||u.map(A=>{A.permissions.map(h=>{h===Te&&(s.CREATE=!0),h===Se&&(s.EDIT=!0,l+="- update -"),h===De&&(s.DELETE=!0,l+="- delete -")})}),N(s),y(l)},[o]);const[d,g]=t.useState(void 0),[m,te]=t.useState(!1),{result:v,type:we,state:Ce,refreshData:ke}=Pe("select",null),{result:r}=_e(m,d),[S,le]=t.useState(void 0),[ie,D]=t.useState(!1),[ce,P]=t.useState(""),[re,ne]=t.useState("insert"),[E,R]=t.useState("list"),[be,oe]=t.useState({});t.useEffect(()=>{d&&te(!m)},[d]),t.useEffect(()=>{console.log(23)},[S]);const _=[{id:1,value:10},{id:2,value:30},{id:3,value:50}],de=[{key:"",name:I},{key:"full_name",name:"نام و نام خانوادگی",img:!1},{key:"driverNatNum",name:"کد ملی"}],w=[{id:1,value:10},{id:2,value:30},{id:3,value:50}],me=[{key:"name",name:"عنوان",img:!1},{key:"date",name:"تاریخ",type:"caleadar",key2:"fromdate"}],[n,he]=t.useState([]),[i,C]=t.useState([]);t.useEffect(()=>{var s;v&&pe((s=v==null?void 0:v.data)==null?void 0:s.data)},[v]),t.useEffect(()=>{var s;console.log(78,r,d),r&&(console.log(79,r),ue(),ve((s=r==null?void 0:r.data)==null?void 0:s.data))},[r]);const pe=s=>{he(()=>s.map(l=>{var c;return{...l,driverNatNum:(c=l==null?void 0:l.details)==null?void 0:c.nat_num}}))},ve=async s=>{var l,c,u,A,h,X,Y,Z;C(()=>s.map(ee=>({...ee,allActivity:ee.allActivity.map(ae=>({...ae,date:Ae(ae.date)}))}))),(A=(u=(c=(l=s[0])==null?void 0:l.driverInfo[0])==null?void 0:c.details)==null?void 0:u.attachFile)!=null&&A.driverPic&&le(await Ie((Z=(Y=(X=(h=s[0])==null?void 0:h.driverInfo[0])==null?void 0:X.details)==null?void 0:Y.attachFile)==null?void 0:Z.driverPic))},ue=()=>{C([]),fe(),D(!1),P(""),oe({}),ne("insert")},fe=()=>{},Ne=(s,l)=>{console.log(100,s,l),l==="update"&&g(s==null?void 0:s._id)};return a("div",{className:"agance-profile-component agance-component",children:[f&&e("i",{className:"fa fa-arrow-left back-icon",onClick:f}),ie&&a("div",{className:"myAttachImage",children:[e("img",{className:"upload-img",src:ce}),e("i",{className:"fa fa-remove close-icon",onClick:()=>{D(!1),P("")}})]}),e("div",{className:"row",children:a("div",{className:"col-12",children:[e("div",{className:"page-title",children:e("i",{onClick:()=>{R("list")},className:E==="list"?"active":"",children:"لیست پروفایل ها"})}),e("div",{className:"page-title",children:e("i",{onClick:()=>{R("insert")},className:E==="insert"?"active":"",children:re==="insert"?p:"پروفایل "})})]})}),e("div",{style:{display:`${E==="list"?"":"none"}`},className:"row",children:a("div",{className:"col-12",children:[(n==null?void 0:n.length)>0&&e(se,{clickOnRow:Ne,pagesize:_[0].value,items:n,options:_,thead:de}),(n==null?void 0:n.length)<=0&&a("p",{style:{marginTop:"40px"},children:[" ","موردی برای نمایش وجود ندارد"]})]})}),a("div",{style:{display:`${E==="insert"?"":"none"}`},className:"aganceRegister-component",children:[a("div",{className:"part part1",children:[e("div",{className:"row title",children:a("div",{className:"col-12 ",children:[e("div",{className:"page-title",children:" اطلاعات هویتی"}),e("hr",{className:"hr-title"})]})}),a("div",{className:"row items",children:[e("img",{src:S,alt:"",className:"img-driverPic"}),a("div",{className:"col-12",children:[e("span",{children:"نام و نام خانوادگی"}),a("span",{children:[" ",(b=(k=i[0])==null?void 0:k.driverInfo[0])==null?void 0:b.full_name]})]}),a("div",{className:"col-12",children:[e("span",{children:"کد ملی"}),a("span",{children:[" ",(G=(F=(x=i[0])==null?void 0:x.driverInfo[0])==null?void 0:F.details)==null?void 0:G.nat_num]})]}),a("div",{className:"col-12",children:[e("span",{children:"   شماره تماس"}),a("span",{children:[" ",(O=(L=i[0])==null?void 0:L.driverInfo[0])==null?void 0:O.phone]})]})]})]}),a("div",{className:"part part2",children:[e("div",{className:"row title",children:a("div",{className:"col-12",children:[e("div",{className:"page-title",children:" اطلاعات خودرو"}),e("hr",{className:"hr-title"})]})}),a("div",{className:"row items",children:[a("div",{className:"col-12",children:[e("span",{children:"   شماره پلاک"}),e("span",{children:((U=(B=i[0])==null?void 0:B.vehicleInfo[0])==null?void 0:U.plaque)&&e(Re,{disabled:!0,small:!0,value:ye((z=(q=i[0])==null?void 0:q.vehicleInfo[0])==null?void 0:z.plaque)})})]}),a("div",{className:"col-12",children:[e("span",{children:"   نوع خودرو "}),a("span",{children:[" ",(V=(M=(j=i[0])==null?void 0:j.vehicleInfo[0])==null?void 0:M.extra)==null?void 0:V.type," "]})]}),a("div",{className:"col-12",children:[e("span",{children:"   رنگ خودرو "}),a("span",{children:[" ",(W=(J=($=i[0])==null?void 0:$.vehicleInfo[0])==null?void 0:J.extra)==null?void 0:W.color," "]})]})]})]}),a("div",{className:"part part3",children:[e("div",{className:"row title",children:a("div",{className:"col-12",children:[e("div",{className:"page-title",children:" گزارش عملکرد "}),e("hr",{className:"hr-title"})]})}),e("div",{className:"row items",children:a("div",{className:"col-12",children:[((H=i[0])==null?void 0:H.allActivity)&&e(se,{pagesize:w[0].value,items:(K=i[0])==null?void 0:K.allActivity,options:w,thead:me}),!((Q=i[0])!=null&&Q.allActivity)&&a("p",{style:{marginTop:"40px"},children:[" ","موردی برای نمایش وجود ندارد"]})]})})]})]})]})};export{Oe as default};
