import{r as l,h as b,c as u,k as x,j as w}from"./index-0b0339af.js";function C({permissions:e,include_external_base:f,search_all:r}){console.log(8798,e,r);const[L,o]=l.useState(null),[i,c]=l.useState({in_progress:!1});async function d(S=""){return new Promise((a,m)=>{c({...i,in_progress:!0}),b().getPermittedUserList(e,S,f,r).then(({data:n})=>{o(n),a(n)}).catch(m).finally(()=>{c({...i,in_progress:!1})})})}return l.useEffect(()=>{d()},[]),{userList:L,state:i,refreshData:d}}function v(e){return u("div",{className:x(e.className,"spinner-container"),children:u("div",{className:x(e.spinnerClassName,"loading-spinner")})})}function N(e){var m;const[f,r]=l.useState({suggestionList:[],isLoading:!0}),[L,o]=l.useState(!1),i=l.useRef(null);l.useEffect(()=>{e.componentRef!=null&&(e.componentRef.current={},e.componentRef.current.triggerConfirm=c)});const c=()=>{i.current==null||e.onFreeConfirm==null||(e.onFreeConfirm(i.current.value),i.current.value="")},d=n=>{const s=n.target.value.trim();if(e.dataSource&&s){const t=e.dataSource.data.filter(h=>e.dataSource?e.dataSource.onFilter(h,s):!1);r({suggestionList:t,isLoading:!1}),o(!0)}else e.readFromDataSource!=null?e.readFromDataSource(s).then(t=>{r({suggestionList:t,isLoading:!1}),o(!0)}).catch(console.log):(r({suggestionList:[],isLoading:!1}),o(!1))},S=n=>{e.onSuggestionSelected(n),r({suggestionList:[],isLoading:!1}),o(!1),i.current!=null&&(i.current.value="",i.current.focus())},a={...e};return delete a.dataSource,delete a.dataSourceUrl,delete a.onSuggestionSelected,delete a.suggestionRenderer,w("div",{className:"SuggestionTextInput-component",children:[u("input",{className:"form-control search",...a,ref:i,onChange:d,type:"text",onKeyDown:function(n){var t,h;const g=n.target;if(n.key==="Enter"&&i.current!=null&&e.onFreeConfirm!=null){c();return}const s=((t=g.nextSibling)==null?void 0:t.childNodes.length)||0;n.code==(e.showListOnTop?"ArrowUp":"ArrowDown")&&s>0&&((h=g.nextSibling)==null?void 0:h.childNodes[0]).focus()}}),w("div",{className:"ul-user",style:{display:L?"block":"none"},children:[u("i",{className:"fa fa-close search-close",onClick:()=>o(!1)}),w("ul",{children:[f.isLoading&&u(v,{spinnerClassName:"w-8 h-8"}),(m=f.suggestionList)==null?void 0:m.map((n,g)=>g>10?"":u("li",{tabIndex:0,className:"cursor-pointer outline outline-0 duration-200 hover:bg-gray-2 focus:bg-gray-4",onKeyDown:function(s){const t=s.target;s.preventDefault(),s.code=="Enter"&&S(n),e.showListOnTop?(s.code=="ArrowUp"&&t.nextSibling&&t.nextSibling.focus(),s.code=="ArrowDown"&&t.previousSibling&&t.previousSibling.focus()):(s.code=="ArrowDown"&&t.nextSibling&&t.nextSibling.focus(),s.code=="ArrowUp"&&t.previousSibling&&t.previousSibling.focus())},onClick:()=>S(n),children:e.suggestionRenderer(n)},n.id))]})]})]})}export{N as S,C as u};
