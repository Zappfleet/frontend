import{r as f,j as h,c as t,i as _,F as b,aD as y}from"./index-4b638fea.js";import{C as D}from"./Chips-0adb3513.js";import{u as C,S as F}from"./SuggestionTextInput-de8ae0dd.js";function p(e){const{permissions:l,freeInput:o,showListOnTop:d=!0,externalState:r,include_external_base:a,search_all:i}=e,{refreshData:S}=C({permissions:l,include_external_base:a,search_all:i}),g=f.useState(e.value||[]),s=r!=null?r[0]:g[0],u=r!=null?r[1]:g[1],x=f.useRef();f.useEffect(()=>{e.onChange!=null&&e.onChange({target:{name:e.name,value:s}})},[s]);const v=n=>{!o||n.trim().length==0||u([...s,{is_free:!0,full_name:n.trim(),_id:new Date().getTime().toString()}])},N=async function(c){return new Promise((m,R)=>S(c).then(m).catch(R))},U=n=>{var c;u(s.filter(m=>n._id!=m._id)),(c=e.onChipsItemRemoved)==null||c.call(e,n)};return h("div",{className:"UsersSuggestionInput-component",children:[t("div",{className:"search-users",children:t(F,{componentRef:x,wrapperClassName:"flex-1",showListOnTop:d,onSuggestionSelected:n=>{s.find(c=>c._id==n._id)==null&&u([...s,n])},onFreeConfirm:v,placeholder:"جستجو ...",readFromDataSource:N,suggestionRenderer:n=>t("div",{children:n.full_name})})}),t("div",{className:_({hidden:e.hideChips}),children:t(P,{smallChips:e.smallChips,list:e.value||s,onChipsItemClick:e.onChipsItemClick,handleRemove:e.handle_remove||U})})]})}function P({list:e,onChipsItemClick:l,handleRemove:o,smallChips:d,highlights:r}){return t(b,{children:t("div",{className:"UsersSuggestionInput-component",children:t("div",{className:"selected-user",children:e.map(a=>t(D,{className:_("duration-300",{"!bg-gray-5":a.is_free,"!bg-secondary":a.is_external,"cursor-pointer":l!=null,"!py-0":d,"border-4 border-transparent":r!=null,"!border-highlight":(r==null?void 0:r.find(i=>i._id==a._id))!=null}),children:h("span",{onClick:i=>{l==null||l(a)},className:"flex items-center justify-center",children:[t(y,{onClick:i=>{i.stopPropagation(),o(a)},className:"cursor-pointer pr-2",size:32}),t("span",{className:_("pl-4 pr-1",{"text-xl":!d,"text-sm":d}),children:a.full_name})]})},a._id))})})})}export{p as U,P as a};
