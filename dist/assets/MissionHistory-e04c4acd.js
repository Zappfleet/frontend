import{a_ as I,a$ as z,r as v,z as H,b as t,j as u,b0 as B,b1 as P,F as D,v as X,aZ as U,b2 as V,b3 as G,b4 as q,w as J}from"./index-a6150745.js";import{u as Z}from"./useItemSetToggle-8cfcb24a.js";import{r as C}from"./renderUi-054e105a.js";import{e as w}from"./comments-4f6f4135.js";var K="Expected a function",k=0/0,Q="[object Symbol]",Y=/^\s+|\s+$/g,ee=/^[-+]0x[0-9a-f]+$/i,te=/^0b[01]+$/i,ne=/^0o[0-7]+$/i,re=parseInt,ce=typeof I=="object"&&I&&I.Object===Object&&I,ae=typeof self=="object"&&self&&self.Object===Object&&self,ie=ce||ae||Function("return this")(),de=Object.prototype,le=de.toString,oe=Math.max,se=Math.min,O=function(){return ie.Date.now()};function ue(e,n,r){var i,s,c,l,d,h,b=0,a=!1,f=!1,m=!0;if(typeof e!="function")throw new TypeError(K);n=M(n)||0,R(r)&&(a=!!r.leading,f="maxWait"in r,c=f?oe(M(r.maxWait)||0,n):c,m="trailing"in r?!!r.trailing:m);function g(o){var E=i,j=s;return i=s=void 0,b=o,l=e.apply(j,E),l}function p(o){return b=o,d=setTimeout(T,n),a?g(o):l}function x(o){var E=o-h,j=o-b,L=n-E;return f?se(L,c-j):L}function N(o){var E=o-h,j=o-b;return h===void 0||E>=n||E<0||f&&j>=c}function T(){var o=O();if(N(o))return S(o);d=setTimeout(T,x(o))}function S(o){return d=void 0,m&&i?g(o):(i=s=void 0,l)}function y(){d!==void 0&&clearTimeout(d),b=0,i=h=s=d=void 0}function W(){return d===void 0?l:S(O())}function _(){var o=O(),E=N(o);if(i=arguments,s=this,h=o,E){if(d===void 0)return p(h);if(f)return d=setTimeout(T,n),g(h)}return d===void 0&&(d=setTimeout(T,n)),l}return _.cancel=y,_.flush=W,_}function R(e){var n=typeof e;return!!e&&(n=="object"||n=="function")}function fe(e){return!!e&&typeof e=="object"}function he(e){return typeof e=="symbol"||fe(e)&&le.call(e)==Q}function M(e){if(typeof e=="number")return e;if(he(e))return k;if(R(e)){var n=typeof e.valueOf=="function"?e.valueOf():e;e=R(n)?n+"":n}if(typeof e!="string")return e===0?e:+e;e=e.replace(Y,"");var r=te.test(e);return r||ne.test(e)?re(e.slice(2),r?2:8):ee.test(e)?k:+e}var me=ue;const $=z(me);var A=typeof window<"u"?v.useLayoutEffect:v.useEffect;function ve(e,n,r,i){const s=v.useRef(n);A(()=>{s.current=n},[n]),v.useEffect(()=>{const c=(r==null?void 0:r.current)??window;if(!(c&&c.addEventListener))return;const l=d=>{s.current(d)};return c.addEventListener(e,l,i),()=>{c.removeEventListener(e,l,i)}},[e,r,i])}function be(e){const n=v.useRef(e);n.current=e,v.useEffect(()=>()=>{n.current()},[])}function ge(e,n=500,r){const i=v.useRef();be(()=>{i.current&&i.current.cancel()});const s=v.useMemo(()=>{const c=$(e,n,r),l=(...d)=>c(...d);return l.cancel=()=>{c.cancel()},l.isPending=()=>!!i.current,l.flush=()=>c.flush(),l},[e,n,r]);return v.useEffect(()=>{i.current=$(e,n,r)},[e,n,r]),s}var F=typeof window>"u";function pe(e={}){let{initializeWithValue:n=!0}=e;F&&(n=!1);const r=()=>{if(!F)return window.screen},[i,s]=v.useState(()=>{if(n)return r()}),c=ge(s,e==null?void 0:e.debounceDelay);function l(){const d=r(),h=e!=null&&e.debounceDelay?c:s;if(d){const{width:b,height:a,availHeight:f,availWidth:m,colorDepth:g,orientation:p,pixelDepth:x}=d;h({width:b,height:a,availHeight:f,availWidth:m,colorDepth:g,orientation:p,pixelDepth:x})}}return ve("resize",l),A(()=>{l()},[]),i}function Se(e={}){var b;const{mode:n,paging:r,status:i}=e,s=n===U,{missions:c}=s===!0?H({mode:n,status:i,paging:r}):[];console.log(741,c,r);const{items:l,toggleItem:d}=Z({onlyOne:!0});pe(),v.useEffect(()=>{console.log(2e3,c)},[c]);const h=a=>{var g;const f=(g=a==null?void 0:a.extra)!=null&&g.comments?a.extra.comments:void 0,m=f==null?void 0:f.map(p=>{var x,N,T,S;return u(D,{children:[t("div",{className:"com0",children:t("span",{className:"title",children:`نظر ${p.role==="driver"?"راننده":"مسافر"}`})}),u("div",{className:"com1",children:[t("i",{style:{color:(x=w.find(y=>y.key===p.emojiID))==null?void 0:x.color},className:(N=w.find(y=>y.key===p.emojiID))==null?void 0:N.icon}),t("span",{children:(T=w.find(y=>y.key===p.emojiID))==null?void 0:T.value})]}),t("div",{className:"com2",children:t("p",{children:p.customComment})}),t("div",{className:"com3",children:(S=p.comments)==null?void 0:S.map(y=>t("span",{className:y.type,children:y.value}))})]})});return m?t("div",{className:"request-mycomment",children:u("div",{className:"row",children:[t("div",{className:"col-2 title",children:"نظرات"}),t("div",{className:"col-10",children:m})]})}):null};return t("div",{className:"MissionHistory-component",children:t("div",{className:"row",children:t("div",{className:"col-12 have-table",children:u("table",{className:"table table-hover",children:[t("thead",{children:u("tr",{children:[t("th",{children:"تاریخ و ساعت"}),t("th",{children:"ایجاد توسط"}),t("th",{children:"توزیع توسط"}),t("th",{children:"مسافت "}),t("th",{children:"وضعیت"}),C(t("th",{})).if(s),t("th",{children:""})]})}),u("tbody",{children:[console.log(12,c),B.isArray(c==null?void 0:c.data)&&((b=c==null?void 0:c.data)==null?void 0:b.map(a=>{const f=P.find(g=>g[0]===a.status),m=l.includes(a._id);return u(D,{children:[u("tr",{children:[t("td",{children:a.mission_date&&X(a.mission_date)}),t("td",{children:a.created_by}),u("td",{children:[a.dispature,a._id]}),t("td",{children:a.distance}),t("td",{children:f?f[1]:"نا مشخص"}),C(t("td",{children:t("div",{children:t("a",{href:`/driver/active?mission_id=${a._id}`,children:t("i",{className:"fa fa-eye icon-view"})})})})).if(s),t("td",{onClick:()=>d(a._id),children:t("i",{className:` angle-icon fa ${m?"fa-angle-down":"fa-angle-up"}`})})]},a._id),t("tr",{style:{display:m?"contents":"none"},children:t("td",{colSpan:6,children:t("div",{className:"expand",children:u("div",{children:[t(ye,{mission:a}),h(a)]})})})})]})}))]})]})})})})}function ye({mission:e}){var n;return t("table",{children:u("tbody",{children:[u("tr",{children:[t("td",{className:"name",children:V}),t("td",{children:e==null?void 0:e.project_Code})]}),u("tr",{children:[t("td",{className:"name",children:G}),t("td",{children:e==null?void 0:e.cost_center})]}),u("tr",{children:[t("td",{className:"name",children:q}),t("td",{children:t("ul",{children:(n=e==null?void 0:e.locations)==null?void 0:n.map(({meta:r},i)=>t(D,{children:u("li",{children:[t("span",{children:` ${J(e.locations.length,i)} `}),r.address]})}))})})]})]})})}export{Se as M};
