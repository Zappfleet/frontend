import{r as a,f as i,j as l,c as s}from"./index-4b638fea.js";import{M as D}from"./MapContainer-a1f86b32.js";import{L as M}from"./LocationSearch-0c7343c4.js";import{u as U}from"./useNeshanApi-69a62daf.js";import{u as q}from"./useFavorite-7253379e.js";import"./renderUi-10abc2ba.js";const O=()=>{const[g,c]=a.useState("select"),[C,m]=a.useState(null),[o,n]=a.useState(!0),{result:t,type:u,refreshData:N}=q(o,g,C),d=a.useRef(),{searchState:L}=U(),[P,f]=a.useState(!1),[w,h]=a.useState(""),[S,v]=a.useState(""),[r,I]=a.useState(),[p,R]=a.useState(null),[y,F]=a.useState(!1);a.useEffect(()=>{},[p,g]),a.useEffect(()=>{t&&(u==="select"&&t.status===200&&(R(t==null?void 0:t.data),c(""),n(!o),f(!1),h(""),v("")),u==="insert"&&(t.status===200?(i.showSuccess("مکان منتخب اضافه شد"),c("select"),n(!o)):i.showError("مکان منتخب اضافه نشد")),u==="delete"&&(t.status===200?(i.showSuccess("مکان منتخب حذف شد"),c("select"),n(!o)):i.showError("مکان منتخب حذف نشد")),u==="update"&&(t.status===200?(i.showSuccess("مکان منتخب بروزرسانی شد"),F(!1),c("select"),n(!o),f(!1),h(""),v("")):i.showError("مکان منتخب بروزرسانی نشد")),f(!1))},[t]);const _=()=>{if(L.inProgress||d.current==null)return;const e=d.current.getCenterLonLat();e!=null&&(I(e),f(!0))},b=async()=>{if(y===!0){if(!r||r.length!==2){console.error("Invalid coordinates:",r);return}const e=C;e.name=w,e.description=S,e.location={type:"Point",coordinates:r},c("update"),m(e),n(!o),await N()}else{if(!r||r.length!==2){console.error("Invalid coordinates:",r);return}const e={name:w,description:S,location:{type:"Point",coordinates:r}};c("insert"),m(e),n(!o),await N()}};a.useEffect(()=>{},[o]);const j=async e=>{console.log(752),c("delete"),m(e),n(!0),await N()},T=e=>{var E,x;const[k,A]=(E=e==null?void 0:e.location)==null?void 0:E.coordinates;(x=d.current)==null||x.viewCoordinates(k,A,16),h(e.name),v(e.description),m(e),F(!0)};return l("div",{className:"PassengerFavoriteLocation-component",children:[s("div",{className:"row",children:s("div",{className:"col-12",children:s("div",{className:"select",children:p==null?void 0:p.map(e=>l("div",{className:"favorite-name",children:[e.name,s("i",{onClick:k=>j(e),className:"fa fa-remove remove-icon"}),s("i",{onClick:k=>T(e),className:"fa fa-edit edit-icon"})]}))})})}),s("div",{className:"row",children:s("div",{className:"col-12",children:l("div",{className:"insert",children:[s("div",{className:"row",children:s("div",{className:"col-12",children:l("div",{className:"location-div",children:[s(D,{mapRef:d}),l("div",{className:"marker-div",children:[s("i",{className:"fa fa-map-marker marker-icon"}),s("span",{children:"منتخب"})]}),s(M,{mapRef:d,className:"loc-search"}),s("i",{onClick:_,className:"fa fa-check check-icon"})]})})}),P&&s("div",{className:"row",children:s("div",{className:"col-12",children:l("div",{className:"favorite-form",children:[s("i",{onClick:()=>f(!1),className:"fa fa-arrow-left icon-back"}),s("input",{value:w,onChange:e=>h(e.target.value),className:"name form-control",type:"text",placeholder:"نام"}),s("textarea",{rows:5,value:S,onChange:e=>v(e.target.value),className:"des form-control",placeholder:"جزییات برای مسیریابی بهتر"}),s("button",{onClick:b,className:"my-btn form-control",children:y===!0?"بروزرسانی":"ثبت"})]})})})]})})})]})};export{O as default};
