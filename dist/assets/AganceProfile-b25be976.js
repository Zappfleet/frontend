import{r as t,h as Ae,u as ye,be as Ie,j as a,c as e,ar as le,a2 as De,bU as Se,bV as Te,bW as Pe}from"./index-0b0339af.js";/* empty css              */import{u as Re}from"./useAganceDriver-234fe48a.js";import{P as we}from"./PlaqueInput-c27a0f7a.js";function _e(I,n){const[d,S]=t.useState(null),[D,T]=t.useState(null),[g,m]=t.useState({in_progress:!1});function N(){Ae().selectAganceProfileByDriverId(n).then(h=>{S(h),T("selectVehicleByDriverID")}).catch(h=>{console.error(6001,"useAgenceVehicle selectVehicleByDriverID Error fetching list:",h)}).finally(()=>{m({...g,in_progress:!1})})}return t.useEffect(()=>{console.log(780,n),n&&N()},[n]),{result:d,type:D,state:g,refreshData:N}}const Ge=({handleBackClick:I,title:n})=>{var x,F,L,O,B,G,U,q,z,V,j,M,W,$,H,J,K,Q,X,Y;n="پروفایل";const{authInfo:d}=ye(),[S,D]=t.useState(""),[T,g]=t.useState({CREATE:!1,EDIT:!1,DELETE:!1});t.useEffect(()=>{var i,v;let s={CREATE:!1,EDIT:!1,DELETE:!1},l="";(v=(i=d==null?void 0:d.auth)==null?void 0:i.roles)==null||v.map(A=>{A.permissions.map(f=>{f===Se&&(s.CREATE=!0),f===Te&&(s.EDIT=!0,l+="- update -"),f===Pe&&(s.DELETE=!0,l+="- delete -")})}),g(s),D(l)},[d]);const[m,N]=t.useState(void 0),[h,ce]=t.useState(!1),{result:u,type:Ce,state:ke,refreshData:be}=Re("select",null),{result:r}=_e(h,m),[P,ie]=t.useState(void 0),[ne,R]=t.useState(!1),[re,w]=t.useState(""),[oe,de]=t.useState("insert"),[E,_]=t.useState("list"),[xe,me]=t.useState({});t.useEffect(()=>{console.log(2),m&&ce(!h)},[m]),t.useEffect(()=>{console.log(23)},[P]);const C=[{id:1,value:10},{id:2,value:30},{id:3,value:50}],he=[{key:"",name:"-view-"},{key:"full_name",name:"نام و نام خانوادگی",img:!1},{key:"driverNatNum",name:"کد ملی"}],k=[{id:1,value:10},{id:2,value:30},{id:3,value:50}],fe=[{key:"name",name:"عنوان",img:!1},{key:"date",name:"تاریخ",type:"caleadar",key2:"fromdate",onlyDate:!0}],[o,ue]=t.useState([]),[c,b]=t.useState([]);t.useEffect(()=>{var s;u&&ve((s=u==null?void 0:u.data)==null?void 0:s.data)},[u]),t.useEffect(()=>{console.log(45,c)},[c]),t.useEffect(()=>{var s;console.log(78,r,m),r&&(console.log(79,r),ge(),pe((s=r==null?void 0:r.data)==null?void 0:s.data))},[r]);const ve=s=>{ue(()=>s.map(l=>{var i;return{...l,driverNatNum:(i=l==null?void 0:l.details)==null?void 0:i.nat_num}}))},pe=async s=>{var l,i,v,A,f,Z,ee,ae;console.log(500,s),b(()=>s.map(p=>{var se,te;return{...p,allActivity:[...p.allActivity,...(te=(se=p==null?void 0:p.driverInfo[0])==null?void 0:se.details)==null?void 0:te.activityArchive].map(y=>({...y,date:y==null?void 0:y.date}))}})),(A=(v=(i=(l=s[0])==null?void 0:l.driverInfo[0])==null?void 0:i.details)==null?void 0:v.attachFile)!=null&&A.driverPic&&ie(await Ie((ae=(ee=(Z=(f=s[0])==null?void 0:f.driverInfo[0])==null?void 0:Z.details)==null?void 0:ee.attachFile)==null?void 0:ae.driverPic))},ge=()=>{b([]),Ne(),R(!1),w(""),me({}),de("insert")},Ne=()=>{},Ee=(s,l)=>{console.log(100,s,l),l==="view"&&(console.log(4),N(s==null?void 0:s._id))};return a("div",{className:"agance-profile-component agance-component",children:[I&&e("i",{className:"fa fa-arrow-left back-icon",onClick:I}),ne&&a("div",{className:"myAttachImage",children:[e("img",{className:"upload-img",src:re}),e("i",{className:"fa fa-remove close-icon",onClick:()=>{R(!1),w("")}})]}),e("div",{className:"row",children:a("div",{className:"col-12",children:[e("div",{className:"page-title",children:e("i",{onClick:()=>{_("list")},className:E==="list"?"active":"",children:"لیست پروفایل ها"})}),e("div",{className:"page-title",children:e("i",{onClick:()=>{_("insert")},className:E==="insert"?"active":"",children:oe==="insert"?n:"پروفایل "})})]})}),e("div",{style:{display:`${E==="list"?"":"none"}`},className:"row",children:a("div",{className:"col-12",children:[(o==null?void 0:o.length)>0&&e(le,{clickOnRow:Ee,pagesize:C[0].value,items:o,options:C,thead:he}),(o==null?void 0:o.length)<=0&&a("p",{style:{marginTop:"40px"},children:[" ","موردی برای نمایش وجود ندارد"]})]})}),a("div",{style:{display:`${E==="insert"?"":"none"}`},className:"aganceRegister-component",children:[a("div",{className:"part part1",children:[e("div",{className:"row title",children:a("div",{className:"col-12 ",children:[e("div",{className:"page-title",children:" اطلاعات هویتی"}),e("hr",{className:"hr-title"})]})}),a("div",{className:"row items",children:[e("img",{src:P,alt:"",className:"img-driverPic"}),a("div",{className:"col-12",children:[e("span",{children:"نام و نام خانوادگی"}),a("span",{children:[" ",(F=(x=c[0])==null?void 0:x.driverInfo[0])==null?void 0:F.full_name]})]}),a("div",{className:"col-12",children:[e("span",{children:"کد ملی"}),a("span",{children:[" ",(B=(O=(L=c[0])==null?void 0:L.driverInfo[0])==null?void 0:O.details)==null?void 0:B.nat_num]})]}),a("div",{className:"col-12",children:[e("span",{children:"   شماره تماس"}),a("span",{children:[" ",(U=(G=c[0])==null?void 0:G.driverInfo[0])==null?void 0:U.phone]})]})]})]}),a("div",{className:"part part2",children:[e("div",{className:"row title",children:a("div",{className:"col-12",children:[e("div",{className:"page-title",children:" اطلاعات خودرو"}),e("hr",{className:"hr-title"})]})}),a("div",{className:"row items",children:[a("div",{className:"col-12",children:[e("span",{children:"   شماره پلاک"}),e("span",{children:((z=(q=c[0])==null?void 0:q.vehicleInfo[0])==null?void 0:z.plaque)&&e(we,{disabled:!0,small:!0,value:De((j=(V=c[0])==null?void 0:V.vehicleInfo[0])==null?void 0:j.plaque)})})]}),a("div",{className:"col-12",children:[e("span",{children:"   نوع خودرو "}),a("span",{children:[" ",($=(W=(M=c[0])==null?void 0:M.vehicleInfo[0])==null?void 0:W.extra)==null?void 0:$.type," "]})]}),a("div",{className:"col-12",children:[e("span",{children:"   رنگ خودرو "}),a("span",{children:[" ",(K=(J=(H=c[0])==null?void 0:H.vehicleInfo[0])==null?void 0:J.extra)==null?void 0:K.color," "]})]})]})]}),a("div",{className:"part part3",children:[e("div",{className:"row title",children:a("div",{className:"col-12",children:[e("div",{className:"page-title",children:" گزارش عملکرد "}),e("hr",{className:"hr-title"})]})}),e("div",{className:"row items",children:a("div",{className:"col-12",children:[((Q=c[0])==null?void 0:Q.allActivity)&&e(le,{pagesize:k[0].value,items:(X=c[0])==null?void 0:X.allActivity,options:k,thead:fe}),!((Y=c[0])!=null&&Y.allActivity)&&a("p",{style:{marginTop:"40px"},children:[" ","موردی برای نمایش وجود ندارد"]})]})})]})]})]})};export{Ge as default};
