import{r as a,x as w,b as u,h as b,j as x}from"./index-a6150745.js";function C({permissions:e,include_external_base:f,search_all:l}){const[L,r]=a.useState(null),[i,c]=a.useState({in_progress:!1});async function d(S=""){return new Promise((o,m)=>{c({...i,in_progress:!0}),w().getPermittedUserList(e,S,f,l).then(({data:n})=>{r(n),o(n)}).catch(m).finally(()=>{c({...i,in_progress:!1})})})}return a.useEffect(()=>{d()},[]),{userList:L,state:i,refreshData:d}}function v(e){return u("div",{className:b(e.className,"spinner-container"),children:u("div",{className:b(e.spinnerClassName,"loading-spinner")})})}function N(e){var m;const[f,l]=a.useState({suggestionList:[],isLoading:!0}),[L,r]=a.useState(!1),i=a.useRef(null);a.useEffect(()=>{e.componentRef!=null&&(e.componentRef.current={},e.componentRef.current.triggerConfirm=c)});const c=()=>{i.current==null||e.onFreeConfirm==null||(e.onFreeConfirm(i.current.value),i.current.value="")},d=n=>{const s=n.target.value.trim();if(e.dataSource&&s){const t=e.dataSource.data.filter(h=>e.dataSource?e.dataSource.onFilter(h,s):!1);l({suggestionList:t,isLoading:!1}),r(!0)}else e.readFromDataSource!=null?e.readFromDataSource(s).then(t=>{l({suggestionList:t,isLoading:!1}),r(!0)}).catch(console.log):(l({suggestionList:[],isLoading:!1}),r(!1))},S=n=>{e.onSuggestionSelected(n),l({suggestionList:[],isLoading:!1}),r(!1),i.current!=null&&(i.current.value="",i.current.focus())},o={...e};return delete o.dataSource,delete o.dataSourceUrl,delete o.onSuggestionSelected,delete o.suggestionRenderer,x("div",{className:"SuggestionTextInput-component",children:[u("input",{className:"form-control search",...o,ref:i,onChange:d,type:"text",onKeyDown:function(n){var t,h;const g=n.target;if(n.key==="Enter"&&i.current!=null&&e.onFreeConfirm!=null){c();return}const s=((t=g.nextSibling)==null?void 0:t.childNodes.length)||0;n.code==(e.showListOnTop?"ArrowUp":"ArrowDown")&&s>0&&((h=g.nextSibling)==null?void 0:h.childNodes[0]).focus()}}),x("div",{className:"ul-user",style:{display:L?"block":"none"},children:[u("i",{className:"fa fa-close search-close",onClick:()=>r(!1)}),x("ul",{children:[f.isLoading&&u(v,{spinnerClassName:"w-8 h-8"}),(m=f.suggestionList)==null?void 0:m.map((n,g)=>g>10?"":u("li",{tabIndex:0,className:"cursor-pointer outline outline-0 duration-200 hover:bg-gray-2 focus:bg-gray-4",onKeyDown:function(s){const t=s.target;s.preventDefault(),s.code=="Enter"&&S(n),e.showListOnTop?(s.code=="ArrowUp"&&t.nextSibling&&t.nextSibling.focus(),s.code=="ArrowDown"&&t.previousSibling&&t.previousSibling.focus()):(s.code=="ArrowDown"&&t.nextSibling&&t.nextSibling.focus(),s.code=="ArrowUp"&&t.previousSibling&&t.previousSibling.focus())},onClick:()=>S(n),children:e.suggestionRenderer(n)},n.id))]})]})]})}export{N as S,C as u};
