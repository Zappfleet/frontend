import{r as s,y as _,u as ce,f as k,j as c,c as e,aq as le,F as ne,bK as ie,bL as oe,bM as de}from"./index-4b638fea.js";/* empty css              */import{O as $,F as ue}from"./FileUpload-a1b75713.js";import{P as he}from"./Page403-34de9313.js";function me(N,h){const[A,y]=s.useState(null),[R,m]=s.useState(null),[i,o]=s.useState({in_progress:!1});function C(){switch(N){case"select":o({...i,in_progress:!0}),_().select_TarefeAvarez().then(r=>{y(r),m("select")}).catch(r=>{console.error(6001,"Error fetching list:",r)}).finally(()=>{o({...i,in_progress:!1})});break;case"insert":h!==null&&(o({...i,in_progress:!0}),_().insert_TarefeAvarez(h).then(r=>{y(r),m("insert")}).catch(r=>{console.error(6001,"Error fetching list:",r)}).finally(()=>{o({...i,in_progress:!1})}));break;case"update":h!==null&&(o({...i,in_progress:!0}),_().update_TarefeAvarez(h).then(r=>{y(r),m("update")}).catch(r=>{console.error(6001,"Error fetching list:",r)}).finally(()=>{o({...i,in_progress:!1})}));break;case"delete":o({...i,in_progress:!0}),_().delete_TarefeAvarez(h._id).then(r=>{y(r),m("delete")}).catch(r=>{console.error(6001,"Error fetching list:",r)}).finally(()=>{o({...i,in_progress:!1})});break}}return s.useEffect(()=>{N&&C()},[N]),{result:A,type:R,state:i,refreshData:C}}const Ae=({handleBackClick:N,title:h})=>{var j,G,M,L,V,Z;h="ثبت تعرفه عوارض";const{authInfo:A}=ce(),[y,R]=s.useState(""),[m,i]=s.useState({CREATE:!1,EDIT:!1,DELETE:!1});s.useEffect(()=>{var v,E;let a={CREATE:!1,EDIT:!1,DELETE:!1},n="";(E=(v=A==null?void 0:A.auth)==null?void 0:v.roles)==null||E.map(T=>{T.permissions.map(u=>{u===ie&&(a.CREATE=!0),u===oe&&(a.EDIT=!0,n+="- update -"),u===de&&(a.DELETE=!0,n+="- delete -")})}),i(a),R(n)},[A]);const o=s.useRef(null),C=a=>{a.current&&a.current.clearFileInput()},r=s.useRef(new $),b=r.current;s.useEffect(()=>{d({...t,_id:b.toString()})},[b]);const[q,w]=s.useState(!1),[P,I]=s.useState(""),[K,p]=s.useState("select"),[f,F]=s.useState("insert"),[S,x]=s.useState("list"),[D,O]=s.useState({}),[t,d]=s.useState({}),U=[{id:1,value:10},{id:2,value:30},{id:3,value:50}],H=[{key:"",name:y},{key:"year",name:"سال",img:!1}],[g,J]=s.useState([]),[Q,W]=s.useState([]),{result:l,type:X,state:pe,refreshData:fe}=me(K,t);s.useEffect(()=>{var a,n;if(l)switch(X){case"insert":(l==null?void 0:l.status)===200?(k.showSuccess("تعرفه عوارض ثبت شد"),p("select")):k.showError("  تعرفه عوارض ثبت نشد");break;case"update":(l==null?void 0:l.status)===200?(k.showSuccess("تعرفه عوارض ویرایش شد"),p("select")):k.showError("تعرفه عوارض ویرایش نشد");break;case"delete":(l==null?void 0:l.status)===200?(k.showSuccess("تعرفه عوارض حذف شد"),p("select")):k.showError("تعرفه عوارض حذف نشد");break;case"select":W((a=l==null?void 0:l.data)==null?void 0:a.data),Y((n=l==null?void 0:l.data)==null?void 0:n.data),z();break}},[l]);const Y=a=>{J(()=>a.map(n=>({...n})))},z=()=>{B(),w(!1),I(""),r.current=new $,d({}),O({}),p(null),F("insert")},B=()=>{C("madarek")},ee=(a,n,v,E)=>{O(T=>({...T,[n]:a})),E===!1&&d({...t,attachFile:{...t.attachFile,[n]:v}})};s.useEffect(()=>{console.log(741,D)},[D]);const ae=a=>{switch(a){case"insert":p("insert");break;case"update":p("update");break}},te=(a,n)=>{var v,E,T;if(n==="delete"&&(d(a),p("delete")),n==="update"){B();const u=Q.filter(re=>re._id===a._id)[0];(v=u==null?void 0:u.attachFile)!=null&&v.madarek&&((T=o.current)==null||T.setFileInput((E=u==null?void 0:u.attachFile)==null?void 0:E.madarek)),d(u),F("update")}};s.useEffect(()=>{},[t]),s.useEffect(()=>{},[P]);const se=a=>{I(D[a]),w(!0)};return c("div",{className:"RegisterTarefeAvarez-component agance-component",children:[N&&e("i",{className:"fa fa-arrow-left back-icon",onClick:N}),q&&c("div",{className:"myAttachImage",children:[e("img",{className:"upload-img",src:P}),e("i",{className:"fa fa-remove close-icon",onClick:()=>{w(!1),I("")}})]}),e("div",{className:"row",children:c("div",{className:"col-12",children:[e("div",{className:"page-title",children:e("i",{onClick:()=>{x("list")},className:S==="list"?"active":"",children:"لیست تعرفه عوارض "})}),e("div",{className:"page-title",children:e("i",{onClick:()=>{x("insert")},className:S==="insert"?"active":"",children:f==="insert"?h:"بروزرسانی تعرفه عوارض "})})]})}),e("div",{style:{display:`${S==="list"?"":"none"}`},className:"row",children:c("div",{className:"col-12",children:[(g==null?void 0:g.length)>0&&e(le,{clickOnRow:te,pagesize:U[0].value,items:g,options:U,thead:H}),(g==null?void 0:g.length)<=0&&c("p",{style:{marginTop:"40px"},children:[" ","موردی برای نمایش وجود ندارد"]})]})}),c("div",{style:{display:`${S==="insert"?"":"none"}`},className:"aganceRegister-component",children:[f==="insert"&&m.CREATE===!1&&c("p",{children:[" ",e(he,{})]}),(f==="insert"&&m.CREATE===!0||f==="update")&&e(ne,{children:c("div",{className:"row",children:[e("div",{className:"col-12",children:f==="update"&&e("button",{onClick:()=>{z(),F("insert")},className:"my-btn",children:h})}),e("div",{className:"col-6",children:c("div",{className:"form-group",children:[e("p",{children:" سال  "}),c("select",{onChange:a=>d({...t,year:a.target.value}),className:"form-control",value:(t==null?void 0:t.year)||"1",children:[e("option",{value:"1",children:"---انتخاب کنید---"}),e("option",{value:"1400",children:"1400"}),e("option",{value:"1401",children:"1401"}),e("option",{value:"1402",children:"1402"}),e("option",{value:"1403",children:"1403"}),e("option",{value:"1404",children:"1404"})]})]})}),e("div",{className:"col-6",children:c("div",{className:"form-group",children:[e("p",{children:" صدور کارت صلاحیت (ریال)"}),e("input",{onChange:a=>d({...t,sodureCaretSalahiyat:a.target.value.replace(/,/g,"")}),value:((j=t==null?void 0:t.sodureCaretSalahiyat)==null?void 0:j.replace(/\B(?=(\d{3})+(?!\d))/g,","))||"",type:"text",className:"form-control"})]})}),e("div",{className:"col-6",children:c("div",{className:"form-group",children:[e("p",{children:" تمدید کارت صلاحیت (ریال)"}),e("input",{onChange:a=>d({...t,tamdidCaretSalahiyat:a.target.value.replace(/,/g,"")}),value:((G=t==null?void 0:t.tamdidCaretSalahiyat)==null?void 0:G.replace(/\B(?=(\d{3})+(?!\d))/g,","))||"",type:"text",className:"form-control"})]})}),e("div",{className:"col-6",children:c("div",{className:"form-group",children:[e("p",{children:"صدور پروانه آژانس (ریال)"}),e("input",{onChange:a=>d({...t,sodureParvaneAgance:a.target.value.replace(/,/g,"")}),value:((M=t==null?void 0:t.sodureParvaneAgance)==null?void 0:M.replace(/\B(?=(\d{3})+(?!\d))/g,","))||"",type:"text",className:"form-control"})]})}),e("div",{className:"col-6",children:c("div",{className:"form-group",children:[e("p",{children:"عوارض سالیانه آژانس (ریال)"}),e("input",{onChange:a=>d({...t,AvarezaSaliyaneAgance:a.target.value.replace(/,/g,"")}),value:((L=t==null?void 0:t.AvarezaSaliyaneAgance)==null?void 0:L.replace(/\B(?=(\d{3})+(?!\d))/g,","))||"",type:"text",className:"form-control"})]})}),e("div",{className:"col-6",children:c("div",{className:"form-group",children:[e("p",{children:" کارشناسی پرونده (ریال)"}),e("input",{onChange:a=>d({...t,karshenasiParvande:a.target.value.replace(/,/g,"")}),value:((V=t==null?void 0:t.karshenasiParvande)==null?void 0:V.replace(/\B(?=(\d{3})+(?!\d))/g,","))||"",type:"text",className:"form-control"})]})}),e("div",{className:"col-6",children:c("div",{className:"form-group",children:[e("p",{children:" بارگزاری مدارک مصوب نرخ"}),c("div",{className:"file-upload-div",children:[e(ue,{ref:o,name:"madarek",id:b.toString(),handleGetBase64:ee}),((Z=t==null?void 0:t.attachFile)==null?void 0:Z.madarek)&&e("i",{className:"fa fa-eye my-eye-icon",onClick:()=>se("madarek")})]})]})}),e("div",{className:"col-12",children:c("div",{className:"form-group",children:[e("button",{onClick:()=>ae(f==="insert"?"insert":"update"),className:"my-btn",children:f==="insert"?"ثبت":"بروز رسانی"}),e("button",{onClick:()=>z(),className:"my-btn",children:"انصراف"})]})})]})})]})]})};export{Ae as default};
