import{a_ as I,a$ as H,r as v,A as z,c as n,j as f,b0 as B,b1 as P,F as D,w as X,aZ as U,b2 as V,b3 as G,b4 as q,x as J}from"./index-4b638fea.js";import{u as Z}from"./useItemSetToggle-3f1f039f.js";import{r as C}from"./renderUi-10abc2ba.js";import{e as w}from"./comments-4f6f4135.js";var K="Expected a function",k=0/0,Q="[object Symbol]",Y=/^\s+|\s+$/g,ee=/^[-+]0x[0-9a-f]+$/i,ne=/^0b[01]+$/i,te=/^0o[0-7]+$/i,re=parseInt,ce=typeof I=="object"&&I&&I.Object===Object&&I,ae=typeof self=="object"&&self&&self.Object===Object&&self,ie=ce||ae||Function("return this")(),de=Object.prototype,le=de.toString,oe=Math.max,se=Math.min,O=function(){return ie.Date.now()};function ue(e,t,r){var i,s,c,l,d,h,b=0,a=!1,u=!1,m=!0;if(typeof e!="function")throw new TypeError(K);t=M(t)||0,R(r)&&(a=!!r.leading,u="maxWait"in r,c=u?oe(M(r.maxWait)||0,t):c,m="trailing"in r?!!r.trailing:m);function g(o){var E=i,j=s;return i=s=void 0,b=o,l=e.apply(j,E),l}function p(o){return b=o,d=setTimeout(x,t),a?g(o):l}function T(o){var E=o-h,j=o-b,L=t-E;return u?se(L,c-j):L}function N(o){var E=o-h,j=o-b;return h===void 0||E>=t||E<0||u&&j>=c}function x(){var o=O();if(N(o))return S(o);d=setTimeout(x,T(o))}function S(o){return d=void 0,m&&i?g(o):(i=s=void 0,l)}function y(){d!==void 0&&clearTimeout(d),b=0,i=h=s=d=void 0}function W(){return d===void 0?l:S(O())}function _(){var o=O(),E=N(o);if(i=arguments,s=this,h=o,E){if(d===void 0)return p(h);if(u)return d=setTimeout(x,t),g(h)}return d===void 0&&(d=setTimeout(x,t)),l}return _.cancel=y,_.flush=W,_}function R(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function fe(e){return!!e&&typeof e=="object"}function he(e){return typeof e=="symbol"||fe(e)&&le.call(e)==Q}function M(e){if(typeof e=="number")return e;if(he(e))return k;if(R(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=R(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(Y,"");var r=ne.test(e);return r||te.test(e)?re(e.slice(2),r?2:8):ee.test(e)?k:+e}var me=ue;const $=H(me);var A=typeof window<"u"?v.useLayoutEffect:v.useEffect;function ve(e,t,r,i){const s=v.useRef(t);A(()=>{s.current=t},[t]),v.useEffect(()=>{const c=(r==null?void 0:r.current)??window;if(!(c&&c.addEventListener))return;const l=d=>{s.current(d)};return c.addEventListener(e,l,i),()=>{c.removeEventListener(e,l,i)}},[e,r,i])}function be(e){const t=v.useRef(e);t.current=e,v.useEffect(()=>()=>{t.current()},[])}function ge(e,t=500,r){const i=v.useRef();be(()=>{i.current&&i.current.cancel()});const s=v.useMemo(()=>{const c=$(e,t,r),l=(...d)=>c(...d);return l.cancel=()=>{c.cancel()},l.isPending=()=>!!i.current,l.flush=()=>c.flush(),l},[e,t,r]);return v.useEffect(()=>{i.current=$(e,t,r)},[e,t,r]),s}var F=typeof window>"u";function pe(e={}){let{initializeWithValue:t=!0}=e;F&&(t=!1);const r=()=>{if(!F)return window.screen},[i,s]=v.useState(()=>{if(t)return r()}),c=ge(s,e==null?void 0:e.debounceDelay);function l(){const d=r(),h=e!=null&&e.debounceDelay?c:s;if(d){const{width:b,height:a,availHeight:u,availWidth:m,colorDepth:g,orientation:p,pixelDepth:T}=d;h({width:b,height:a,availHeight:u,availWidth:m,colorDepth:g,orientation:p,pixelDepth:T})}}return ve("resize",l),A(()=>{l()},[]),i}function Se(e={}){var b;const{mode:t,paging:r,status:i}=e,s=t===U,{missions:c}=s===!0?z({mode:t,status:i,paging:r}):[];console.log(741,c,r);const{items:l,toggleItem:d}=Z({onlyOne:!0});pe(),v.useEffect(()=>{console.log(2e3,c)},[c]);const h=a=>{var g;const u=(g=a==null?void 0:a.extra)!=null&&g.comments?a.extra.comments:void 0,m=u==null?void 0:u.map(p=>{var T,N,x,S;return f(D,{children:[n("div",{className:"com0",children:n("span",{className:"title",children:`نظر ${p.role==="driver"?"راننده":"مسافر"}`})}),f("div",{className:"com1",children:[n("i",{style:{color:(T=w.find(y=>y.key===p.emojiID))==null?void 0:T.color},className:(N=w.find(y=>y.key===p.emojiID))==null?void 0:N.icon}),n("span",{children:(x=w.find(y=>y.key===p.emojiID))==null?void 0:x.value})]}),n("div",{className:"com2",children:n("p",{children:p.customComment})}),n("div",{className:"com3",children:(S=p.comments)==null?void 0:S.map(y=>n("span",{className:y.type,children:y.value}))})]})});return m?n("div",{className:"request-mycomment",children:f("div",{className:"row",children:[n("div",{className:"col-2 title",children:"نظرات"}),n("div",{className:"col-10",children:m})]})}):null};return n("div",{className:"MissionHistory-component",children:n("div",{className:"row",children:n("div",{className:"col-12 have-table",children:f("table",{className:"table table-hover",children:[n("thead",{children:f("tr",{children:[n("th",{children:"تاریخ و ساعت"}),n("th",{children:"ایجاد توسط"}),n("th",{children:"توزیع توسط"}),n("th",{children:"مسافت "}),n("th",{children:"وضعیت"}),C(n("th",{})).if(s),n("th",{children:""})]})}),f("tbody",{children:[console.log(12,c),B.isArray(c==null?void 0:c.data)&&((b=c==null?void 0:c.data)==null?void 0:b.map(a=>{const u=P.find(g=>g[0]===a.status),m=l.includes(a._id);return f(D,{children:[f("tr",{children:[n("td",{children:a.mission_date&&X(a.mission_date)}),n("td",{children:a.created_by}),n("td",{children:a.dispature}),n("td",{children:a.distance}),n("td",{children:u?u[1]:"نا مشخص"}),C(n("td",{children:n("div",{children:n("a",{href:`/driver/active?mission_id=${a._id}`,children:n("i",{className:"fa fa-eye icon-view"})})})})).if(s),n("td",{onClick:()=>d(a._id),children:n("i",{className:` angle-icon fa ${m?"fa-angle-down":"fa-angle-up"}`})})]},a._id),n("tr",{style:{display:m?"contents":"none"},children:n("td",{colSpan:6,children:n("div",{className:"expand",children:f("div",{children:[n(ye,{mission:a}),h(a)]})})})})]})}))]})]})})})})}function ye({mission:e}){var t;return n("table",{children:f("tbody",{children:[f("tr",{children:[n("td",{className:"name",children:V}),n("td",{children:e==null?void 0:e.project_Code})]}),f("tr",{children:[n("td",{className:"name",children:G}),n("td",{children:e==null?void 0:e.cost_center})]}),f("tr",{children:[n("td",{className:"name",children:q}),n("td",{children:n("ul",{children:(t=e==null?void 0:e.locations)==null?void 0:t.map(({meta:r},i)=>n(D,{children:f("li",{children:[n("span",{children:` ${J(e.locations.length,i)} `}),r.address]})}))})})]})]})})}export{Se as M};
