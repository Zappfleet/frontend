import{r as i,j as v,b as c,h as y,S as _,x as p}from"./index-a6150745.js";import{u as R,g as S}from"./useNeshanApi-89a34043.js";import{r as b}from"./renderUi-054e105a.js";const m=u=>{var n;const{searchState:t,searchAddress:a,clearAddressSearch:h}=R(),o=i.useRef(),d=r=>{if(r.target.value.trim().length==0){h();return}const e=u.mapRef.current.getCenterLonLat();a(r.target.value,e[1],e[0])},l=r=>{h(),u.mapRef.current.viewCoordinates(r.location.x,r.location.y,16)},s=t.inProgress||t.searchResult!=null;return v("div",{className:"LocationSearch-component flex-center",children:[c("input",{onChange:d,className:"map-btn",placeholder:"جستجوی نقشه ...",onKeyDown:function(r){r.code=="ArrowDown"&&t.searchResult!=null&&t.searchResult.length>0&&o.current.children[0].focus()}}),v("div",{className:y("loc-search-result duration-300 absolute top-12 left-1 right-1 rounded bg-white p-1",{"opacity-100 -translate-y-0 pointer-events-auto":s,"opacity-0 -translate-y-2 pointer-events-none":!s}),children:[b(c(_,{})).if(t.inProgress),b(c("div",{children:"هیچ مکانی پیدا نشد!"})).if(t.searchResult!=null&&t.searchResult.length==0),c("ul",{ref:o,className:y("duration-300 ",{"opacity-0":t.searchResult==null,"opacity-100":t.searchResult!=null}),children:(n=t.searchResult)==null?void 0:n.map((r,e)=>{if(!(e>10))return c("li",{tabIndex:0,onKeyDown:function(f){const g=f.target;f.code=="Enter"&&l(r),f.code=="ArrowDown"&&g.nextSibling&&g.nextSibling.focus(),f.code=="ArrowUp"&&g.previousSibling&&g.previousSibling.focus()},onClick:()=>l(r),className:"p-2 cursor-pointer outline-none focus:bg-gray-4 hover:bg-gray-4 active:bg-gray-4",children:S(r)},`${r.title}${r.location.x}${r.location.y}`)})})]})]})};function F(u,t,a){const[h,o]=i.useState(null),[d,l]=i.useState(null),[s,n]=i.useState({in_progress:!1});async function r(){switch(t){case"select":n({...s,in_progress:!0}),p().select_FavoriteLocation().then(e=>{o(e),l("select")}).catch(e=>{console.error(6001,"Error fetching Favorite list:",e)}).finally(()=>{n({...s,in_progress:!1})});break;case"insert":a!==null&&(n({...s,in_progress:!0}),p().insert_FavoriteLocation(a).then(e=>{o(e),l("insert")}).catch(e=>{console.error(6001,"Error fetching Favorite list:",e)}).finally(()=>{n({...s,in_progress:!1})}));break;case"update":console.log(41,a),a!==null&&(n({...s,in_progress:!0}),p().update_FavoriteLocation(a).then(e=>{o(e),l("update")}).catch(e=>{console.error(6001,"Error fetching Favorite list:",e)}).finally(()=>{n({...s,in_progress:!1})}));break;case"delete":n({...s,in_progress:!0}),p().delete_FavoriteLocation(a._id).then(e=>{o(e),l("delete")}).catch(e=>{console.error(6001,"Error fetching Favorite list:",e)}).finally(()=>{n({...s,in_progress:!1})});break}}return i.useEffect(()=>{r()},[u]),{result:h,state:s,type:d,refreshData:r}}export{m as L,F as u};
