import{r as e,u as Y,f as D,U as N,j as m,c as l,F as x,bG as v,bH as P,bI as G,bd as M}from"./index-0b0339af.js";import{u as H}from"./useAganceDriver-234fe48a.js";import{H as k}from"./HTMLProcessor-1d27b86a.js";import"./style-65f980a9.js";const B=({})=>{const[_,C]=e.useState(null);e.useEffect(()=>{fetch("/zarghanFiles/govahiFaaliystDriver/govahiFaaliystDriver.htm").then(a=>a.text()).then(a=>{C(a)}).catch(a=>console.error(a))},[]);const y="گواهی فعالیت راننده",{authInfo:E}=Y(),[K,F]=e.useState(""),[U,g]=e.useState({CREATE:!1,EDIT:!1,DELETE:!1});e.useEffect(()=>{var u,h;let a={CREATE:!1,EDIT:!1,DELETE:!1},t="";(h=(u=E==null?void 0:E.auth)==null?void 0:u.roles)==null||h.map(f=>{f.permissions.map(i=>{i===v&&(a.CREATE=!0),i===P&&(a.EDIT=!0,t+="- update -"),i===G&&(a.DELETE=!0,t+="- delete -")})}),g(a),F(t)},[E]);const[d,w]=e.useState([]),[o,R]=e.useState({}),[j,p]=e.useState("select"),[n,r]=e.useState(null),{result:s,type:I}=H(j,n);e.useEffect(()=>{var a,t,u;if(s)switch(I){case"select":w((a=s==null?void 0:s.data)==null?void 0:a.data);break;case"update":r(null),p("select"),console.log(41,s),((t=s==null?void 0:s.data)==null?void 0:t.status)==200&&D.showSuccess("اطلاعات ثبت شد"),((u=s==null?void 0:s.data)==null?void 0:u.status)!=200&&D.showError("اطلاعات ثبت نشد");break}},[s]),e.useEffect(()=>{},[o]),e.useState(N(new Date).format("jYYYY/jMM/jDD")),e.useState(N(new Date).format("jYYYY/jMM/jDD")),e.useState(!1),e.useState(""),e.useState(""),e.useState({id:Math.floor(1e4+Math.random()*9e4),title:"",description:"",attachFileName:"",status:"open",createDate:new Date}),e.useEffect(()=>{console.log(45,n)},[n]);const L=a=>{var u,h,f,i;const t=d.filter(c=>{var T,S,A;return((T=c==null?void 0:c.details)==null?void 0:T.nat_num)===a.target.value&&((S=c==null?void 0:c.details)==null?void 0:S.nat_num)!==null&&((A=c==null?void 0:c.details)==null?void 0:A.nat_num)!==void 0})[0];t&&r(t),R({full_name:(t==null?void 0:t.full_name)||"---",father_name:((u=t==null?void 0:t.details)==null?void 0:u.fatherName)||"---",nat_num:a.target.value,activity_place:((h=t==null?void 0:t.details)==null?void 0:h.activityContext)||"---",from_date:((f=t==null?void 0:t.details)==null?void 0:f.fishDate)&&M((i=t==null?void 0:t.details)==null?void 0:i.fishDate)||"---",to_date:M(Date())||"---"})},b=()=>{var t;const a={...n,details:{...(n==null?void 0:n.details)||{},activityArchive:[...((t=n==null?void 0:n.details)==null?void 0:t.activityArchive)||[],{name:"درخواست گواهی فعالیت",date:new Date().toISOString()}]}};r(a),p("update")};return m("div",{className:"aganceCarteSalahiyat-component",children:[l("div",{className:"row",children:l("div",{className:"col-12",children:l("div",{className:"page-title",children:l("i",{children:y})})})}),m("div",{className:"row",children:[l("div",{className:"col-12",children:m("div",{className:"form-group",children:[m("span",{children:["    ","کد ملی را وارد کنید","   "]}),m("select",{onChange:a=>L(a),className:"form-control",value:(o==null?void 0:o.nat_num)||"1",children:[l("option",{value:"1",children:"---انتخاب کنید---"}),d==null?void 0:d.map(a=>{var t;return l("option",{value:(t=a==null?void 0:a.details)==null?void 0:t.nat_num,children:a==null?void 0:a.full_name})})]})]})}),l("div",{className:"row",children:l("div",{className:"col-12",children:(o==null?void 0:o.nat_num)&&_!==null&&m(x,{children:[l("button",{onClick:()=>b(),className:"my-btn",children:"ذخیره در بایگانی "}),l(k,{autoReadFile:!0,HTMLFile:_,fields:o})]})})})]})]})};export{B as default};
